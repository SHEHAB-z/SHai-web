// Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ù…Ø¹Ø±ÙØ© Ø§Ù„Ø°ÙƒÙŠØ© - SHEHABGPT
// Ù†Ø¸Ø§Ù… Ù…ØªÙ‚Ø¯Ù… Ù„ÙÙ‡Ù… Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙˆØ§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¹Ù„ÙŠÙ‡Ø§

const knowledgeBase = {
    // Ø§Ù„ÙÙŠØ²ÙŠØ§Ø¡
    physics: {
        keywords: ['ÙÙŠØ²ÙŠØ§Ø¡', 'Ù‚ÙˆØ©', 'Ø­Ø±ÙƒØ©', 'Ø³Ø±Ø¹Ø©', 'ØªØ³Ø§Ø±Ø¹', 'ÙƒØªÙ„Ø©', 'Ø·Ø§Ù‚Ø©', 'Ø´ØºÙ„', 'Ù‚Ø¯Ø±Ø©', 'ÙƒÙ‡Ø±Ø¨Ø§Ø¡', 'Ù…ØºÙ†Ø§Ø·ÙŠØ³ÙŠØ©', 'Ø¶ÙˆØ¡', 'ØµÙˆØª', 'Ø­Ø±Ø§Ø±Ø©', 'Ù†ÙŠÙˆØªÙ†', 'Ø£ÙˆÙ…', 'Ø¬ÙˆÙ„', 'ÙˆØ§Ø·'],
        
        topics: {
            'Ù‚ÙˆØ§Ù†ÙŠÙ† Ù†ÙŠÙˆØªÙ†': {
                patterns: ['Ù†ÙŠÙˆØªÙ†', 'Ù‚Ø§Ù†ÙˆÙ† Ø§Ù„Ø­Ø±ÙƒØ©', 'Ø§Ù„Ù‚Ø§Ù†ÙˆÙ† Ø§Ù„Ø£ÙˆÙ„', 'Ø§Ù„Ù‚Ø§Ù†ÙˆÙ† Ø§Ù„Ø«Ø§Ù†ÙŠ', 'Ø§Ù„Ù‚Ø§Ù†ÙˆÙ† Ø§Ù„Ø«Ø§Ù„Ø«'],
                content: {
                    'Ø§Ù„Ù‚Ø§Ù†ÙˆÙ† Ø§Ù„Ø£ÙˆÙ„': 'Ù‚Ø§Ù†ÙˆÙ† Ù†ÙŠÙˆØªÙ† Ø§Ù„Ø£ÙˆÙ„ (Ù‚Ø§Ù†ÙˆÙ† Ø§Ù„Ù‚ØµÙˆØ± Ø§Ù„Ø°Ø§ØªÙŠ): Ø§Ù„Ø¬Ø³Ù… Ø§Ù„Ø³Ø§ÙƒÙ† ÙŠØ¨Ù‚Ù‰ Ø³Ø§ÙƒÙ†Ø§Ù‹ ÙˆØ§Ù„Ø¬Ø³Ù… Ø§Ù„Ù…ØªØ­Ø±Ùƒ ÙŠØ¨Ù‚Ù‰ Ù…ØªØ­Ø±ÙƒØ§Ù‹ Ø¨Ø³Ø±Ø¹Ø© Ø«Ø§Ø¨ØªØ© ÙÙŠ Ø®Ø· Ù…Ø³ØªÙ‚ÙŠÙ… Ù…Ø§ Ù„Ù… ØªØ¤Ø«Ø± Ø¹Ù„ÙŠÙ‡ Ù‚ÙˆØ© Ø®Ø§Ø±Ø¬ÙŠØ©.',
                    'Ø§Ù„Ù‚Ø§Ù†ÙˆÙ† Ø§Ù„Ø«Ø§Ù†ÙŠ': 'Ù‚Ø§Ù†ÙˆÙ† Ù†ÙŠÙˆØªÙ† Ø§Ù„Ø«Ø§Ù†ÙŠ: Ø§Ù„Ù‚ÙˆØ© = Ø§Ù„ÙƒØªÙ„Ø© Ã— Ø§Ù„ØªØ³Ø§Ø±Ø¹ (F = ma). Ù‡Ø°Ø§ ÙŠØ¹Ù†ÙŠ Ø£Ù† Ø§Ù„Ù‚ÙˆØ© Ø§Ù„Ù…Ø¤Ø«Ø±Ø© Ø¹Ù„Ù‰ Ø¬Ø³Ù… ØªØ³Ø§ÙˆÙŠ Ø­Ø§ØµÙ„ Ø¶Ø±Ø¨ ÙƒØªÙ„ØªÙ‡ ÙÙŠ ØªØ³Ø§Ø±Ø¹Ù‡.',
                    'Ø§Ù„Ù‚Ø§Ù†ÙˆÙ† Ø§Ù„Ø«Ø§Ù„Ø«': 'Ù‚Ø§Ù†ÙˆÙ† Ù†ÙŠÙˆØªÙ† Ø§Ù„Ø«Ø§Ù„Ø«: Ù„ÙƒÙ„ ÙØ¹Ù„ Ø±Ø¯ ÙØ¹Ù„ Ù…Ø³Ø§ÙˆÙ Ù„Ù‡ ÙÙŠ Ø§Ù„Ù…Ù‚Ø¯Ø§Ø± ÙˆÙ…Ø¹Ø§ÙƒØ³ Ù„Ù‡ ÙÙŠ Ø§Ù„Ø§ØªØ¬Ø§Ù‡.',
                    'ØªØ·Ø¨ÙŠÙ‚Ø§Øª': 'ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ù‚ÙˆØ§Ù†ÙŠÙ† Ù†ÙŠÙˆØªÙ†: Ø­Ø±ÙƒØ© Ø§Ù„Ø³ÙŠØ§Ø±Ø§ØªØŒ Ø§Ù„ØµÙˆØ§Ø±ÙŠØ®ØŒ Ø§Ù„Ø·Ø§Ø¦Ø±Ø§ØªØŒ Ø§Ù„Ù…ØµØ§Ø¹Ø¯ØŒ ÙˆØ§Ù„ÙƒØ«ÙŠØ± Ù…Ù† Ø§Ù„Ø¸ÙˆØ§Ù‡Ø± Ø§Ù„ÙŠÙˆÙ…ÙŠØ©.'
                }
            },
            
            'Ø§Ù„Ø­Ø±ÙƒØ©': {
                patterns: ['Ø­Ø±ÙƒØ©', 'Ø³Ø±Ø¹Ø©', 'ØªØ³Ø§Ø±Ø¹', 'Ø¥Ø²Ø§Ø­Ø©', 'Ù…Ø³Ø§ÙØ©', 'Ø²Ù…Ù†'],
                content: {
                    'Ø§Ù„Ø³Ø±Ø¹Ø©': 'Ø§Ù„Ø³Ø±Ø¹Ø© = Ø§Ù„Ù…Ø³Ø§ÙØ© Ã· Ø§Ù„Ø²Ù…Ù† (v = d/t). Ø§Ù„Ø³Ø±Ø¹Ø© ÙƒÙ…ÙŠØ© Ù…ØªØ¬Ù‡Ø© Ù„Ù‡Ø§ Ù…Ù‚Ø¯Ø§Ø± ÙˆØ§ØªØ¬Ø§Ù‡.',
                    'Ø§Ù„ØªØ³Ø§Ø±Ø¹': 'Ø§Ù„ØªØ³Ø§Ø±Ø¹ = Ø§Ù„ØªØºÙŠØ± ÙÙŠ Ø§Ù„Ø³Ø±Ø¹Ø© Ã· Ø§Ù„Ø²Ù…Ù† (a = Î”v/t). Ø§Ù„ØªØ³Ø§Ø±Ø¹ Ù‡Ùˆ Ù…Ø¹Ø¯Ù„ ØªØºÙŠØ± Ø§Ù„Ø³Ø±Ø¹Ø©.',
                    'Ù…Ø¹Ø§Ø¯Ù„Ø§Øª Ø§Ù„Ø­Ø±ÙƒØ©': 'Ù…Ø¹Ø§Ø¯Ù„Ø§Øª Ø§Ù„Ø­Ø±ÙƒØ© Ø¨ØªØ³Ø§Ø±Ø¹ Ø«Ø§Ø¨Øª: v = u + atØŒ s = ut + Â½atÂ²ØŒ vÂ² = uÂ² + 2as',
                    'Ø§Ù„Ø³Ù‚ÙˆØ· Ø§Ù„Ø­Ø±': 'Ø§Ù„Ø³Ù‚ÙˆØ· Ø§Ù„Ø­Ø±: Ø­Ø±ÙƒØ© Ø§Ù„Ø£Ø¬Ø³Ø§Ù… ØªØ­Øª ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¬Ø§Ø°Ø¨ÙŠØ© ÙÙ‚Ø·ØŒ Ø§Ù„ØªØ³Ø§Ø±Ø¹ = 9.8 m/sÂ²'
                }
            },
            
            'Ø§Ù„Ø·Ø§Ù‚Ø©': {
                patterns: ['Ø·Ø§Ù‚Ø©', 'Ø´ØºÙ„', 'Ù‚Ø¯Ø±Ø©', 'Ø­Ø±ÙƒÙŠØ©', 'ÙˆØ¶Ø¹', 'Ø­ÙØ¸ Ø§Ù„Ø·Ø§Ù‚Ø©'],
                content: {
                    'Ø§Ù„Ø´ØºÙ„': 'Ø§Ù„Ø´ØºÙ„ = Ø§Ù„Ù‚ÙˆØ© Ã— Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ã— cos(Î¸). Ø§Ù„Ø´ØºÙ„ Ù‡Ùˆ Ø§Ù„Ø·Ø§Ù‚Ø© Ø§Ù„Ù…Ù†Ù‚ÙˆÙ„Ø© Ø¹Ù†Ø¯ ØªØ­Ø±ÙŠÙƒ Ø¬Ø³Ù… Ø¨Ù‚ÙˆØ©.',
                    'Ø·Ø§Ù‚Ø© Ø§Ù„Ø­Ø±ÙƒØ©': 'Ø·Ø§Ù‚Ø© Ø§Ù„Ø­Ø±ÙƒØ© = Â½ Ã— Ø§Ù„ÙƒØªÙ„Ø© Ã— Ø§Ù„Ø³Ø±Ø¹Ø©Â² (KE = Â½mvÂ²)',
                    'Ø·Ø§Ù‚Ø© Ø§Ù„ÙˆØ¶Ø¹': 'Ø·Ø§Ù‚Ø© Ø§Ù„ÙˆØ¶Ø¹ = Ø§Ù„ÙƒØªÙ„Ø© Ã— Ø§Ù„Ø¬Ø§Ø°Ø¨ÙŠØ© Ã— Ø§Ù„Ø§Ø±ØªÙØ§Ø¹ (PE = mgh)',
                    'Ø­ÙØ¸ Ø§Ù„Ø·Ø§Ù‚Ø©': 'Ù‚Ø§Ù†ÙˆÙ† Ø­ÙØ¸ Ø§Ù„Ø·Ø§Ù‚Ø©: Ø§Ù„Ø·Ø§Ù‚Ø© Ù„Ø§ ØªÙÙ†Ù‰ ÙˆÙ„Ø§ ØªÙØ³ØªØ­Ø¯Ø«ØŒ Ø¨Ù„ ØªØªØ­ÙˆÙ„ Ù…Ù† Ø´ÙƒÙ„ Ù„Ø¢Ø®Ø±.',
                    'Ø§Ù„Ù‚Ø¯Ø±Ø©': 'Ø§Ù„Ù‚Ø¯Ø±Ø© = Ø§Ù„Ø´ØºÙ„ Ã· Ø§Ù„Ø²Ù…Ù† (P = W/t). ÙˆØ­Ø¯Ø© Ø§Ù„Ù‚Ø¯Ø±Ø© Ù‡ÙŠ Ø§Ù„ÙˆØ§Ø· (Watt)'
                }
            },
            
            'Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¡': {
                patterns: ['ÙƒÙ‡Ø±Ø¨Ø§Ø¡', 'ØªÙŠØ§Ø±', 'Ø¬Ù‡Ø¯', 'Ù…Ù‚Ø§ÙˆÙ…Ø©', 'Ø£ÙˆÙ…', 'Ø¯Ø§Ø¦Ø±Ø© ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©'],
                content: {
                    'Ù‚Ø§Ù†ÙˆÙ† Ø£ÙˆÙ…': 'Ù‚Ø§Ù†ÙˆÙ† Ø£ÙˆÙ…: Ø§Ù„Ø¬Ù‡Ø¯ = Ø§Ù„ØªÙŠØ§Ø± Ã— Ø§Ù„Ù…Ù‚Ø§ÙˆÙ…Ø© (V = IR). Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø§Ù†ÙˆÙ† Ø£Ø³Ø§Ø³ÙŠ ÙÙŠ Ø§Ù„Ø¯ÙˆØ§Ø¦Ø± Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©.',
                    'Ø§Ù„ØªÙŠØ§Ø± Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ': 'Ø§Ù„ØªÙŠØ§Ø± Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ: ØªØ¯ÙÙ‚ Ø§Ù„Ø´Ø­Ù†Ø§Øª Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©ØŒ ÙŠÙÙ‚Ø§Ø³ Ø¨Ø§Ù„Ø£Ù…Ø¨ÙŠØ± (A)',
                    'Ø§Ù„Ø¬Ù‡Ø¯ Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ': 'Ø§Ù„Ø¬Ù‡Ø¯ Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ: ÙØ±Ù‚ Ø§Ù„Ø¬Ù‡Ø¯ Ø¨ÙŠÙ† Ù†Ù‚Ø·ØªÙŠÙ†ØŒ ÙŠÙÙ‚Ø§Ø³ Ø¨Ø§Ù„ÙÙˆÙ„Øª (V)',
                    'Ø§Ù„Ù…Ù‚Ø§ÙˆÙ…Ø©': 'Ø§Ù„Ù…Ù‚Ø§ÙˆÙ…Ø©: Ù…Ù…Ø§Ù†Ø¹Ø© Ø§Ù„Ù…Ø§Ø¯Ø© Ù„Ù…Ø±ÙˆØ± Ø§Ù„ØªÙŠØ§Ø±ØŒ ØªÙÙ‚Ø§Ø³ Ø¨Ø§Ù„Ø£ÙˆÙ… (Î©)',
                    'Ø§Ù„Ù‚Ø¯Ø±Ø© Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©': 'Ø§Ù„Ù‚Ø¯Ø±Ø© Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ© = Ø§Ù„Ø¬Ù‡Ø¯ Ã— Ø§Ù„ØªÙŠØ§Ø± (P = VI) Ø£Ùˆ P = IÂ²R Ø£Ùˆ P = VÂ²/R'
                }
            }
        }
    },
    
    // Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª
    math: {
        keywords: ['Ø±ÙŠØ§Ø¶ÙŠØ§Øª', 'Ø¬Ø¨Ø±', 'Ù‡Ù†Ø¯Ø³Ø©', 'Ù…Ø¹Ø§Ø¯Ù„Ø©', 'Ø¯Ø§Ù„Ø©', 'ØªÙØ§Ø¶Ù„', 'ØªÙƒØ§Ù…Ù„', 'Ù…Ø«Ù„Ø«Ø§Øª', 'Ø§Ø­ØªÙ…Ø§Ù„Ø§Øª', 'Ø¥Ø­ØµØ§Ø¡'],
        
        topics: {
            'Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø§Øª': {
                patterns: ['Ù…Ø¹Ø§Ø¯Ù„Ø©', 'Ø­Ù„', 'Ø¬Ø°Ø±', 'Ø®Ø·ÙŠØ©', 'ØªØ±Ø¨ÙŠØ¹ÙŠØ©'],
                content: {
                    'Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø© Ø§Ù„Ø®Ø·ÙŠØ©': 'Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø© Ø§Ù„Ø®Ø·ÙŠØ©: ax + b = 0ØŒ Ø§Ù„Ø­Ù„: x = -b/a. Ù…Ø«Ø§Ù„: 2x + 6 = 0ØŒ Ø§Ù„Ø­Ù„: x = -3',
                    'Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø© Ø§Ù„ØªØ±Ø¨ÙŠØ¹ÙŠØ©': 'Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø© Ø§Ù„ØªØ±Ø¨ÙŠØ¹ÙŠØ©: axÂ² + bx + c = 0ØŒ Ø§Ù„Ø­Ù„: x = [-b Â± âˆš(bÂ²-4ac)] / 2a',
                    'Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø§Øª': 'Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø§Øª Ø§Ù„Ø®Ø·ÙŠØ©: ÙŠÙ…ÙƒÙ† Ø­Ù„Ù‡ Ø¨Ø§Ù„ØªØ¹ÙˆÙŠØ¶ØŒ Ø§Ù„Ø­Ø°ÙØŒ Ø£Ùˆ Ø§Ù„Ù…ØµÙÙˆÙØ§Øª',
                    'Ø§Ù„Ù…ØªØ¨Ø§ÙŠÙ†Ø§Øª': 'Ø§Ù„Ù…ØªØ¨Ø§ÙŠÙ†Ø§Øª: Ù…Ø«Ù„ x > 5 Ø£Ùˆ 2x + 3 â‰¤ 10ØŒ ØªÙØ­Ù„ Ø¨Ù†ÙØ³ Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø§Øª Ù…Ø¹ Ù…Ø±Ø§Ø¹Ø§Ø© Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ø¥Ø´Ø§Ø±Ø©'
                }
            },
            
            'Ø§Ù„Ø¯ÙˆØ§Ù„': {
                patterns: ['Ø¯Ø§Ù„Ø©', 'Ù…Ø¬Ø§Ù„', 'Ù…Ø¯Ù‰', 'Ø±Ø³Ù… Ø¨ÙŠØ§Ù†ÙŠ', 'ØªØ­ÙˆÙŠÙ„Ø§Øª'],
                content: {
                    'ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø¯Ø§Ù„Ø©': 'Ø§Ù„Ø¯Ø§Ù„Ø©: Ø¹Ù„Ø§Ù‚Ø© ØªØ±Ø¨Ø· ÙƒÙ„ Ø¹Ù†ØµØ± Ù…Ù† Ø§Ù„Ù…Ø¬Ø§Ù„ Ø¨Ø¹Ù†ØµØ± ÙˆØ§Ø­Ø¯ ÙÙ‚Ø· Ù…Ù† Ø§Ù„Ù…Ø¯Ù‰. f(x) = ...',
                    'Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø¯ÙˆØ§Ù„': 'Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø¯ÙˆØ§Ù„: Ø®Ø·ÙŠØ© (f(x)=mx+b)ØŒ ØªØ±Ø¨ÙŠØ¹ÙŠØ© (f(x)=axÂ²+bx+c)ØŒ Ø£Ø³ÙŠØ© (f(x)=aË£)ØŒ Ù„ÙˆØºØ§Ø±ÙŠØªÙ…ÙŠØ©',
                    'Ø§Ù„Ù…Ø¬Ø§Ù„ ÙˆØ§Ù„Ù…Ø¯Ù‰': 'Ø§Ù„Ù…Ø¬Ø§Ù„: Ù…Ø¬Ù…ÙˆØ¹Ø© Ù‚ÙŠÙ… x Ø§Ù„Ù…Ù…ÙƒÙ†Ø©. Ø§Ù„Ù…Ø¯Ù‰: Ù…Ø¬Ù…ÙˆØ¹Ø© Ù‚ÙŠÙ… f(x) Ø§Ù„Ù†Ø§ØªØ¬Ø©',
                    'ØªØ­ÙˆÙŠÙ„Ø§Øª Ø§Ù„Ø¯ÙˆØ§Ù„': 'Ø§Ù„ØªØ­ÙˆÙŠÙ„Ø§Øª: Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø±Ø£Ø³ÙŠØ© (+k)ØŒ Ø§Ù„Ø£ÙÙ‚ÙŠØ© (-h)ØŒ Ø§Ù„ØªÙ…Ø¯Ø¯ (a)ØŒ Ø§Ù„Ø§Ù†Ø¹ÙƒØ§Ø³ (-)'
                }
            },
            
            'Ø§Ù„ØªÙØ§Ø¶Ù„': {
                patterns: ['ØªÙØ§Ø¶Ù„', 'Ù…Ø´ØªÙ‚Ø©', 'Ù…Ø¹Ø¯Ù„ Ø§Ù„ØªØºÙŠØ±', 'Ù…ÙŠÙ„', 'Ù†Ù‡Ø§ÙŠØ©'],
                content: {
                    'Ø§Ù„Ù…Ø´ØªÙ‚Ø©': 'Ø§Ù„Ù…Ø´ØªÙ‚Ø©: Ù…Ø¹Ø¯Ù„ Ø§Ù„ØªØºÙŠØ± Ø§Ù„Ù„Ø­Ø¸ÙŠ Ù„Ù„Ø¯Ø§Ù„Ø©. f\'(x) = lim[hâ†’0] [f(x+h)-f(x)]/h',
                    'Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„ØªÙØ§Ø¶Ù„': 'Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„ØªÙØ§Ø¶Ù„: (xâ¿)\' = nxâ¿â»Â¹ØŒ (sin x)\' = cos xØŒ (eË£)\' = eË£ØŒ (ln x)\' = 1/x',
                    'ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ù…Ø´ØªÙ‚Ø©': 'ØªØ·Ø¨ÙŠÙ‚Ø§Øª: Ø¥ÙŠØ¬Ø§Ø¯ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø¹Ø¸Ù…Ù‰ ÙˆØ§Ù„ØµØºØ±Ù‰ØŒ Ù…Ø¹Ø¯Ù„ Ø§Ù„ØªØºÙŠØ±ØŒ Ù…ÙŠÙ„ Ø§Ù„Ù…Ù…Ø§Ø³ØŒ Ø§Ù„Ø³Ø±Ø¹Ø© ÙˆØ§Ù„ØªØ³Ø§Ø±Ø¹',
                    'Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø³Ù„Ø³Ù„Ø©': 'Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø³Ù„Ø³Ù„Ø©: [f(g(x))]\' = f\'(g(x)) Ã— g\'(x)'
                }
            },
            
            'Ø§Ù„Ù‡Ù†Ø¯Ø³Ø©': {
                patterns: ['Ù…Ø³Ø§Ø­Ø©', 'Ø­Ø¬Ù…', 'Ù…Ø­ÙŠØ·', 'Ù…Ø«Ù„Ø«', 'Ø¯Ø§Ø¦Ø±Ø©', 'Ù…Ø³ØªØ·ÙŠÙ„', 'Ù…ÙƒØ¹Ø¨'],
                content: {
                    'Ø§Ù„Ù…Ø«Ù„Ø«': 'Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù…Ø«Ù„Ø« = Â½ Ã— Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© Ã— Ø§Ù„Ø§Ø±ØªÙØ§Ø¹. Ù…Ø¬Ù…ÙˆØ¹ Ø²ÙˆØ§ÙŠØ§ Ø§Ù„Ù…Ø«Ù„Ø« = 180Â°',
                    'Ø§Ù„Ø¯Ø§Ø¦Ø±Ø©': 'Ù…Ø­ÙŠØ· Ø§Ù„Ø¯Ø§Ø¦Ø±Ø© = 2Ï€rØŒ Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø¯Ø§Ø¦Ø±Ø© = Ï€rÂ²ØŒ Ø­ÙŠØ« r Ù‡Ùˆ Ù†ØµÙ Ø§Ù„Ù‚Ø·Ø±',
                    'Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„': 'Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„ = Ø§Ù„Ø·ÙˆÙ„ Ã— Ø§Ù„Ø¹Ø±Ø¶ØŒ Ø§Ù„Ù…Ø­ÙŠØ· = 2(Ø§Ù„Ø·ÙˆÙ„ + Ø§Ù„Ø¹Ø±Ø¶)',
                    'Ø§Ù„Ù…ÙƒØ¹Ø¨': 'Ø­Ø¬Ù… Ø§Ù„Ù…ÙƒØ¹Ø¨ = Ø·ÙˆÙ„ Ø§Ù„Ø¶Ù„Ø¹Â³ØŒ Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø³Ø·Ø­ = 6 Ã— Ø·ÙˆÙ„ Ø§Ù„Ø¶Ù„Ø¹Â²',
                    'Ø§Ù„ÙƒØ±Ø©': 'Ø­Ø¬Ù… Ø§Ù„ÙƒØ±Ø© = (4/3)Ï€rÂ³ØŒ Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø³Ø·Ø­ = 4Ï€rÂ²'
                }
            }
        }
    },
    
    // Ø§Ù„ÙƒÙŠÙ…ÙŠØ§Ø¡
    chemistry: {
        keywords: ['ÙƒÙŠÙ…ÙŠØ§Ø¡', 'Ø°Ø±Ø©', 'Ø¬Ø²ÙŠØ¡', 'ØªÙØ§Ø¹Ù„', 'Ø¹Ù†ØµØ±', 'Ù…Ø±ÙƒØ¨', 'Ø­Ù…Ø¶', 'Ù‚Ø§Ø¹Ø¯Ø©', 'Ø£ÙƒØ³Ø¯Ø©', 'Ø§Ø®ØªØ²Ø§Ù„'],
        
        topics: {
            'Ø§Ù„Ø°Ø±Ø©': {
                patterns: ['Ø°Ø±Ø©', 'Ø¨Ø±ÙˆØªÙˆÙ†', 'Ù†ÙŠÙˆØªØ±ÙˆÙ†', 'Ø¥Ù„ÙƒØªØ±ÙˆÙ†', 'Ù†ÙˆØ§Ø©', 'Ø¹Ø¯Ø¯ Ø°Ø±ÙŠ'],
                content: {
                    'ØªØ±ÙƒÙŠØ¨ Ø§Ù„Ø°Ø±Ø©': 'Ø§Ù„Ø°Ø±Ø© ØªØªÙƒÙˆÙ† Ù…Ù†: Ù†ÙˆØ§Ø© (Ø¨Ø±ÙˆØªÙˆÙ†Ø§Øª + Ù†ÙŠÙˆØªØ±ÙˆÙ†Ø§Øª) ÙˆØ¥Ù„ÙƒØªØ±ÙˆÙ†Ø§Øª ØªØ¯ÙˆØ± Ø­ÙˆÙ„Ù‡Ø§',
                    'Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø°Ø±ÙŠ': 'Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø°Ø±ÙŠ = Ø¹Ø¯Ø¯ Ø§Ù„Ø¨Ø±ÙˆØªÙˆÙ†Ø§Øª = Ø¹Ø¯Ø¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†Ø§Øª (ÙÙŠ Ø§Ù„Ø°Ø±Ø© Ø§Ù„Ù…ØªØ¹Ø§Ø¯Ù„Ø©)',
                    'Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„ÙƒØªÙ„ÙŠ': 'Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„ÙƒØªÙ„ÙŠ = Ø¹Ø¯Ø¯ Ø§Ù„Ø¨Ø±ÙˆØªÙˆÙ†Ø§Øª + Ø¹Ø¯Ø¯ Ø§Ù„Ù†ÙŠÙˆØªØ±ÙˆÙ†Ø§Øª',
                    'Ø§Ù„Ù†Ø¸Ø§Ø¦Ø±': 'Ø§Ù„Ù†Ø¸Ø§Ø¦Ø±: Ø°Ø±Ø§Øª Ù„Ù†ÙØ³ Ø§Ù„Ø¹Ù†ØµØ± Ù„Ù‡Ø§ Ù†ÙØ³ Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø°Ø±ÙŠ Ù„ÙƒÙ† Ø¹Ø¯Ø¯ ÙƒØªÙ„ÙŠ Ù…Ø®ØªÙ„Ù'
                }
            },
            
            'Ø§Ù„ØªÙØ§Ø¹Ù„Ø§Øª': {
                patterns: ['ØªÙØ§Ø¹Ù„', 'Ù…Ø¹Ø§Ø¯Ù„Ø© ÙƒÙŠÙ…ÙŠØ§Ø¦ÙŠØ©', 'Ù…ÙˆØ§Ø²Ù†Ø©', 'Ù†ÙˆØ§ØªØ¬', 'Ù…ØªÙØ§Ø¹Ù„Ø§Øª'],
                content: {
                    'Ø§Ù„ØªÙØ§Ø¹Ù„ Ø§Ù„ÙƒÙŠÙ…ÙŠØ§Ø¦ÙŠ': 'Ø§Ù„ØªÙØ§Ø¹Ù„ Ø§Ù„ÙƒÙŠÙ…ÙŠØ§Ø¦ÙŠ: ØªØ­ÙˆÙ„ Ø§Ù„Ù…ØªÙØ§Ø¹Ù„Ø§Øª Ø¥Ù„Ù‰ Ù†ÙˆØ§ØªØ¬. A + B â†’ C + D',
                    'Ù…ÙˆØ§Ø²Ù†Ø© Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø§Øª': 'Ù…ÙˆØ§Ø²Ù†Ø© Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø©: Ø¹Ø¯Ø¯ Ø°Ø±Ø§Øª ÙƒÙ„ Ø¹Ù†ØµØ± ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ù…ØªØ³Ø§ÙˆÙŠØ§Ù‹ ÙÙŠ Ø§Ù„Ø·Ø±ÙÙŠÙ†',
                    'Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„ØªÙØ§Ø¹Ù„Ø§Øª': 'Ø£Ù†ÙˆØ§Ø¹: Ø§ØªØ­Ø§Ø¯ (A+Bâ†’AB)ØŒ ØªØ­Ù„Ù„ (ABâ†’A+B)ØŒ Ø¥Ø­Ù„Ø§Ù„ Ø¨Ø³ÙŠØ·ØŒ Ø¥Ø­Ù„Ø§Ù„ Ù…Ø²Ø¯ÙˆØ¬',
                    'Ø³Ø±Ø¹Ø© Ø§Ù„ØªÙØ§Ø¹Ù„': 'Ø³Ø±Ø¹Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ ØªØªØ£Ø«Ø± Ø¨Ù€: Ø§Ù„ØªØ±ÙƒÙŠØ²ØŒ Ø¯Ø±Ø¬Ø© Ø§Ù„Ø­Ø±Ø§Ø±Ø©ØŒ Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø³Ø·Ø­ÙŠØ©ØŒ Ø§Ù„Ù…Ø­ÙØ²'
                }
            },
            
            'Ø§Ù„Ø£Ø­Ù…Ø§Ø¶ ÙˆØ§Ù„Ù‚ÙˆØ§Ø¹Ø¯': {
                patterns: ['Ø­Ù…Ø¶', 'Ù‚Ø§Ø¹Ø¯Ø©', 'pH', 'ØªØ¹Ø§Ø¯Ù„', 'Ù…Ù„Ø­'],
                content: {
                    'Ø§Ù„Ø£Ø­Ù…Ø§Ø¶': 'Ø§Ù„Ø£Ø­Ù…Ø§Ø¶: Ù…ÙˆØ§Ø¯ ØªØ¹Ø·ÙŠ Ø£ÙŠÙˆÙ†Ø§Øª Hâº ÙÙŠ Ø§Ù„Ù…Ø§Ø¡. Ø·Ø¹Ù…Ù‡Ø§ Ø­Ø§Ù…Ø¶ØŒ ØªØ­ÙˆÙ„ ÙˆØ±Ù‚Ø© Ø¹Ø¨Ø§Ø¯ Ø§Ù„Ø´Ù…Ø³ Ù„Ù„Ø£Ø­Ù…Ø±',
                    'Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯': 'Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯: Ù…ÙˆØ§Ø¯ ØªØ¹Ø·ÙŠ Ø£ÙŠÙˆÙ†Ø§Øª OHâ» ÙÙŠ Ø§Ù„Ù…Ø§Ø¡. Ù…Ù„Ù…Ø³Ù‡Ø§ ØµØ§Ø¨ÙˆÙ†ÙŠØŒ ØªØ­ÙˆÙ„ ÙˆØ±Ù‚Ø© Ø¹Ø¨Ø§Ø¯ Ø§Ù„Ø´Ù…Ø³ Ù„Ù„Ø£Ø²Ø±Ù‚',
                    'pH': 'Ù…Ù‚ÙŠØ§Ø³ pH: Ù…Ù† 0-14. Ø£Ø­Ù…Ø§Ø¶ (0-7)ØŒ Ù…ØªØ¹Ø§Ø¯Ù„ (7)ØŒ Ù‚ÙˆØ§Ø¹Ø¯ (7-14)',
                    'Ø§Ù„ØªØ¹Ø§Ø¯Ù„': 'ØªÙØ§Ø¹Ù„ Ø§Ù„ØªØ¹Ø§Ø¯Ù„: Ø­Ù…Ø¶ + Ù‚Ø§Ø¹Ø¯Ø© â†’ Ù…Ù„Ø­ + Ù…Ø§Ø¡. HCl + NaOH â†’ NaCl + Hâ‚‚O'
                }
            }
        }
    },
    
    // Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
    arabic: {
        keywords: ['Ø¹Ø±Ø¨ÙŠ', 'Ù†Ø­Ùˆ', 'ØµØ±Ù', 'Ø¨Ù„Ø§ØºØ©', 'Ø£Ø¯Ø¨', 'Ø¥Ø¹Ø±Ø§Ø¨', 'ÙØ§Ø¹Ù„', 'Ù…ÙØ¹ÙˆÙ„', 'Ø¬Ù…Ù„Ø©'],
        
        topics: {
            'Ø§Ù„Ù†Ø­Ùˆ': {
                patterns: ['Ù†Ø­Ùˆ', 'Ø¥Ø¹Ø±Ø§Ø¨', 'ÙØ§Ø¹Ù„', 'Ù…ÙØ¹ÙˆÙ„', 'Ù…Ø¨ØªØ¯Ø£', 'Ø®Ø¨Ø±', 'Ø¬Ù…Ù„Ø©'],
                content: {
                    'Ø§Ù„Ø¬Ù…Ù„Ø© Ø§Ù„Ø§Ø³Ù…ÙŠØ©': 'Ø§Ù„Ø¬Ù…Ù„Ø© Ø§Ù„Ø§Ø³Ù…ÙŠØ©: ØªØ¨Ø¯Ø£ Ø¨Ø§Ø³Ù…ØŒ ØªØªÙƒÙˆÙ† Ù…Ù† Ù…Ø¨ØªØ¯Ø£ (Ù…Ø±ÙÙˆØ¹) ÙˆØ®Ø¨Ø± (Ù…Ø±ÙÙˆØ¹). Ù…Ø«Ø§Ù„: Ø§Ù„Ø¹Ù„Ù…Ù Ù†ÙˆØ±ÙŒ',
                    'Ø§Ù„Ø¬Ù…Ù„Ø© Ø§Ù„ÙØ¹Ù„ÙŠØ©': 'Ø§Ù„Ø¬Ù…Ù„Ø© Ø§Ù„ÙØ¹Ù„ÙŠØ©: ØªØ¨Ø¯Ø£ Ø¨ÙØ¹Ù„ØŒ ØªØªÙƒÙˆÙ† Ù…Ù† ÙØ¹Ù„ ÙˆÙØ§Ø¹Ù„ ÙˆÙ…ÙØ¹ÙˆÙ„ Ø¨Ù‡ (Ø¥Ù† ÙˆÙØ¬Ø¯). Ù…Ø«Ø§Ù„: ÙƒØªØ¨Ù Ø§Ù„Ø·Ø§Ù„Ø¨Ù Ø§Ù„Ø¯Ø±Ø³Ù',
                    'Ø§Ù„ÙØ§Ø¹Ù„': 'Ø§Ù„ÙØ§Ø¹Ù„: Ù…Ù† Ù‚Ø§Ù… Ø¨Ø§Ù„ÙØ¹Ù„ØŒ Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ù…Ø±ÙÙˆØ¹. Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„Ø±ÙØ¹: Ø§Ù„Ø¶Ù…Ø©ØŒ Ø§Ù„ÙˆØ§ÙˆØŒ Ø§Ù„Ø£Ù„Ù',
                    'Ø§Ù„Ù…ÙØ¹ÙˆÙ„ Ø¨Ù‡': 'Ø§Ù„Ù…ÙØ¹ÙˆÙ„ Ø¨Ù‡: Ù…Ù† ÙˆÙ‚Ø¹ Ø¹Ù„ÙŠÙ‡ Ø§Ù„ÙØ¹Ù„ØŒ Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ù…Ù†ØµÙˆØ¨. Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„Ù†ØµØ¨: Ø§Ù„ÙØªØ­Ø©ØŒ Ø§Ù„ÙŠØ§Ø¡ØŒ Ø§Ù„ÙƒØ³Ø±Ø©',
                    'Ø§Ù„Ù…Ø¨ØªØ¯Ø£ ÙˆØ§Ù„Ø®Ø¨Ø±': 'Ø§Ù„Ù…Ø¨ØªØ¯Ø£: Ø§Ø³Ù… Ù…Ø±ÙÙˆØ¹ ÙŠÙØ¨ØªØ¯Ø£ Ø¨Ù‡ Ø§Ù„ÙƒÙ„Ø§Ù…. Ø§Ù„Ø®Ø¨Ø±: Ù…Ø§ ÙŠÙØ®Ø¨Ø± Ø¨Ù‡ Ø¹Ù† Ø§Ù„Ù…Ø¨ØªØ¯Ø£ØŒ Ù…Ø±ÙÙˆØ¹'
                }
            },
            
            'Ø§Ù„Ø¨Ù„Ø§ØºØ©': {
                patterns: ['Ø¨Ù„Ø§ØºØ©', 'ØªØ´Ø¨ÙŠÙ‡', 'Ø§Ø³ØªØ¹Ø§Ø±Ø©', 'ÙƒÙ†Ø§ÙŠØ©', 'Ù…Ø¬Ø§Ø²'],
                content: {
                    'Ø§Ù„ØªØ´Ø¨ÙŠÙ‡': 'Ø§Ù„ØªØ´Ø¨ÙŠÙ‡: Ù…Ø´Ø§Ø±ÙƒØ© Ø¨ÙŠÙ† Ø´ÙŠØ¦ÙŠÙ† ÙÙŠ ØµÙØ©. Ø£Ø±ÙƒØ§Ù†Ù‡: Ø§Ù„Ù…Ø´Ø¨Ù‡ØŒ Ø§Ù„Ù…Ø´Ø¨Ù‡ Ø¨Ù‡ØŒ Ø£Ø¯Ø§Ø© Ø§Ù„ØªØ´Ø¨ÙŠÙ‡ØŒ ÙˆØ¬Ù‡ Ø§Ù„Ø´Ø¨Ù‡',
                    'Ø§Ù„Ø§Ø³ØªØ¹Ø§Ø±Ø©': 'Ø§Ù„Ø§Ø³ØªØ¹Ø§Ø±Ø©: ØªØ´Ø¨ÙŠÙ‡ Ø­ÙØ°Ù Ø£Ø­Ø¯ Ø·Ø±ÙÙŠÙ‡. Ù…Ø«Ø§Ù„: Ø±Ø£ÙŠØª Ø£Ø³Ø¯Ø§Ù‹ ÙÙŠ Ø§Ù„Ù…Ø¹Ø±ÙƒØ© (Ø§Ù„Ù…Ù‚ØµÙˆØ¯: Ø±Ø¬Ù„ Ø´Ø¬Ø§Ø¹)',
                    'Ø§Ù„ÙƒÙ†Ø§ÙŠØ©': 'Ø§Ù„ÙƒÙ†Ø§ÙŠØ©: Ù„ÙØ¸ ÙŠÙØ·Ù„Ù‚ ÙˆÙŠÙØ±Ø§Ø¯ Ø¨Ù‡ Ù„Ø§Ø²Ù… Ù…Ø¹Ù†Ø§Ù‡. Ù…Ø«Ø§Ù„: ÙÙ„Ø§Ù† ÙƒØ«ÙŠØ± Ø§Ù„Ø±Ù…Ø§Ø¯ (ÙƒÙ†Ø§ÙŠØ© Ø¹Ù† Ø§Ù„ÙƒØ±Ù…)',
                    'Ø§Ù„Ù…Ø¬Ø§Ø²': 'Ø§Ù„Ù…Ø¬Ø§Ø²: Ø§Ø³ØªØ¹Ù…Ø§Ù„ Ø§Ù„Ù„ÙØ¸ ÙÙŠ ØºÙŠØ± Ù…Ø¹Ù†Ø§Ù‡ Ø§Ù„Ø£ØµÙ„ÙŠ Ù„Ø¹Ù„Ø§Ù‚Ø© Ù…Ø¹ Ù‚Ø±ÙŠÙ†Ø©. Ù…Ø«Ø§Ù„: ÙŠØ¯ Ø§Ù„Ø¯Ù‡Ø± (Ø§Ù„Ù…Ù‚ØµÙˆØ¯: Ø£Ø«Ø± Ø§Ù„Ø²Ù…Ù†)'
                }
            }
        }
    }
};

// Ù…Ø­Ø±Ùƒ Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø°ÙƒÙŠ
class SmartSearchEngine {
    constructor(knowledgeBase) {
        this.kb = knowledgeBase;
    }
    
    // ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø³Ø¤Ø§Ù„ ÙˆØ§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ©
    analyzeQuestion(question) {
        const cleanQuestion = question.toLowerCase()
            .replace(/[ØŸ?!.ØŒ,;:""''()[\]{}]/g, ' ')
            .trim();
        
        const words = cleanQuestion.split(/\s+/).filter(w => w.length > 2);
        
        // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©
        const stopWords = ['Ù…Ø§', 'Ù‡Ùˆ', 'Ù‡ÙŠ', 'ÙÙŠ', 'Ù…Ù†', 'Ø¥Ù„Ù‰', 'Ø¹Ù„Ù‰', 'Ø¹Ù†', 'Ù…Ø¹', 'Ø£Ù†', 'Ø¥Ù†',
            'Ø§Ù„Ø°ÙŠ', 'Ø§Ù„ØªÙŠ', 'Ù‡Ø°Ø§', 'Ù‡Ø°Ù‡', 'Ø°Ù„Ùƒ', 'ØªÙ„Ùƒ', 'ÙƒÙŠÙ', 'Ù„Ù…Ø§Ø°Ø§', 'Ù…ØªÙ‰', 'Ø£ÙŠÙ†',
            'Ù‡Ù„', 'Ù…Ø§Ø°Ø§', 'ÙƒÙ…', 'Ø£ÙŠ', 'ÙƒÙ„', 'Ø¨Ø¹Ø¶', 'Ø¬Ù…ÙŠØ¹', 'Ùˆ', 'Ø£Ùˆ', 'Ù„ÙƒÙ†', 'Ø«Ù…',
            'ÙŠÙƒÙˆÙ†', 'ÙƒØ§Ù†', 'ÙŠØ¹Ù†ÙŠ', 'Ù…Ø¹Ù†Ù‰', 'Ø´Ø±Ø­', 'Ø§Ø´Ø±Ø­', 'ÙˆØ¶Ø­', 'Ø¹Ø±Ù', 'Ø§Ø°ÙƒØ±'];
        
        return words.filter(w => !stopWords.includes(w));
    }
    
    // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø§Ø¯Ø© Ù…Ù† Ø§Ù„Ø³Ø¤Ø§Ù„
    detectSubject(keywords) {
        let scores = {};
        
        for (const [subject, data] of Object.entries(this.kb)) {
            scores[subject] = 0;
            for (const keyword of keywords) {
                if (data.keywords.some(k => keyword.includes(k) || k.includes(keyword))) {
                    scores[subject] += 2;
                }
            }
        }
        
        const maxScore = Math.max(...Object.values(scores));
        if (maxScore > 0) {
            return Object.keys(scores).find(k => scores[k] === maxScore);
        }
        
        return null;
    }
    
    // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨
    findBestTopic(subject, keywords) {
        if (!this.kb[subject] || !this.kb[subject].topics) return null;
        
        let bestTopic = null;
        let bestScore = 0;
        
        for (const [topicName, topicData] of Object.entries(this.kb[subject].topics)) {
            let score = 0;
            
            for (const keyword of keywords) {
                // ØªØ­Ù‚Ù‚ Ù…Ù† patterns
                if (topicData.patterns.some(p => keyword.includes(p) || p.includes(keyword))) {
                    score += 3;
                }
                
                // ØªØ­Ù‚Ù‚ Ù…Ù† Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹
                for (const content of Object.values(topicData.content)) {
                    if (content.toLowerCase().includes(keyword)) {
                        score += 1;
                    }
                }
            }
            
            if (score > bestScore) {
                bestScore = score;
                bestTopic = topicName;
            }
        }
        
        return bestScore > 0 ? bestTopic : null;
    }
    
    // ØªÙˆÙ„ÙŠØ¯ Ø¥Ø¬Ø§Ø¨Ø© Ø°ÙƒÙŠØ©
    generateAnswer(question, subject = null) {
        const keywords = this.analyzeQuestion(question);
        
        if (keywords.length === 0) {
            return 'Ù…Ù† ÙØ¶Ù„ÙƒØŒ Ø§Ø·Ø±Ø­ Ø³Ø¤Ø§Ù„Ø§Ù‹ Ø£ÙƒØ«Ø± ØªØ­Ø¯ÙŠØ¯Ø§Ù‹ Ø­ØªÙ‰ Ø£ØªÙ…ÙƒÙ† Ù…Ù† Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ Ø¨Ø´ÙƒÙ„ Ø£ÙØ¶Ù„.';
        }
        
        // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø§Ø¯Ø©
        const detectedSubject = subject || this.detectSubject(keywords);
        
        if (!detectedSubject) {
            return this.generateGeneralResponse(question, keywords);
        }
        
        // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹
        const topic = this.findBestTopic(detectedSubject, keywords);
        
        if (!topic) {
            return this.generateSubjectResponse(detectedSubject, keywords);
        }
        
        // ØªÙˆÙ„ÙŠØ¯ Ø¥Ø¬Ø§Ø¨Ø© Ù…Ù† Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹
        return this.generateTopicResponse(detectedSubject, topic, keywords);
    }
    
    // Ø¥Ø¬Ø§Ø¨Ø© Ù…Ù† Ù…ÙˆØ¶ÙˆØ¹ Ù…Ø­Ø¯Ø¯
    generateTopicResponse(subject, topic, keywords) {
        const topicData = this.kb[subject].topics[topic];
        const subjectName = this.getSubjectName(subject);
        
        let answer = `<strong>ğŸ“š ${subjectName} - ${topic}:</strong><br><br>`;
        
        // Ø¬Ù…Ø¹ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨
        let relevantContent = [];
        
        for (const [key, content] of Object.entries(topicData.content)) {
            let score = 0;
            for (const keyword of keywords) {
                if (content.toLowerCase().includes(keyword) || key.toLowerCase().includes(keyword)) {
                    score++;
                }
            }
            
            if (score > 0) {
                relevantContent.push({ key, content, score });
            }
        }
        
        // ØªØ±ØªÙŠØ¨ Ø­Ø³Ø¨ Ø§Ù„Ø£Ù‡Ù…ÙŠØ©
        relevantContent.sort((a, b) => b.score - a.score);
        
        // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø­ØªÙˆÙ‰
        if (relevantContent.length > 0) {
            relevantContent.slice(0, 3).forEach(item => {
                answer += `<div style="margin-bottom: 15px;">`;
                answer += `<strong>â€¢ ${item.key}:</strong><br>`;
                answer += `${item.content}`;
                answer += `</div>`;
            });
        } else {
            // Ø¥Ø¶Ø§ÙØ© ÙƒÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰
            for (const [key, content] of Object.entries(topicData.content)) {
                answer += `<div style="margin-bottom: 15px;">`;
                answer += `<strong>â€¢ ${key}:</strong><br>`;
                answer += `${content}`;
                answer += `</div>`;
            }
        }
        
        answer += `<br><div style="padding: 10px; background: rgba(220, 38, 38, 0.1); border-radius: 8px; margin-top: 10px;">`;
        answer += `<strong>ğŸ’¡ Ù†ØµÙŠØ­Ø©:</strong> Ø¥Ø°Ø§ ÙƒÙ†Øª ØªØ±ÙŠØ¯ Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„ØªÙØ§ØµÙŠÙ„ØŒ Ø§Ø³Ø£Ù„ Ø³Ø¤Ø§Ù„Ø§Ù‹ Ø£ÙƒØ«Ø± ØªØ­Ø¯ÙŠØ¯Ø§Ù‹!`;
        answer += `</div>`;
        
        return answer;
    }
    
    // Ø¥Ø¬Ø§Ø¨Ø© Ø¹Ø§Ù…Ø© Ø¹Ù† Ø§Ù„Ù…Ø§Ø¯Ø©
    generateSubjectResponse(subject, keywords) {
        const subjectName = this.getSubjectName(subject);
        const topics = Object.keys(this.kb[subject].topics);
        
        let answer = `<strong>ğŸ“š ${subjectName}:</strong><br><br>`;
        answer += `ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ Ø§Ù„Ù…ÙˆØ§Ø¶ÙŠØ¹ Ø§Ù„ØªØ§Ù„ÙŠØ©:<br><br>`;
        
        topics.forEach(topic => {
            answer += `<strong>â€¢ ${topic}</strong><br>`;
        });
        
        answer += `<br>Ø§Ø³Ø£Ù„ Ø³Ø¤Ø§Ù„Ø§Ù‹ Ù…Ø­Ø¯Ø¯Ø§Ù‹ Ø¹Ù† Ø£ÙŠ Ù…ÙˆØ¶ÙˆØ¹!`;
        
        return answer;
    }
    
    // Ø¥Ø¬Ø§Ø¨Ø© Ø¹Ø§Ù…Ø©
    generateGeneralResponse(question, keywords) {
        return `Ø£ÙÙ‡Ù… Ø³Ø¤Ø§Ù„ÙƒØŒ Ù„ÙƒÙ† Ø£Ø­ØªØ§Ø¬ Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„ØªÙØ§ØµÙŠÙ„:<br><br>
        â€¢ Ø­Ø¯Ø¯ Ø§Ù„Ù…Ø§Ø¯Ø© (ÙÙŠØ²ÙŠØ§Ø¡ØŒ Ø±ÙŠØ§Ø¶ÙŠØ§ØªØŒ ÙƒÙŠÙ…ÙŠØ§Ø¡ØŒ Ø¹Ø±Ø¨ÙŠ...)<br>
        â€¢ Ø§Ø°ÙƒØ± Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹ Ø§Ù„Ù…Ø­Ø¯Ø¯<br>
        â€¢ Ø§Ø·Ø±Ø­ Ø³Ø¤Ø§Ù„Ø§Ù‹ ÙˆØ§Ø¶Ø­Ø§Ù‹<br><br>
        <strong>Ù…Ø«Ø§Ù„:</strong> "Ù…Ø§ Ù‡Ùˆ Ù‚Ø§Ù†ÙˆÙ† Ù†ÙŠÙˆØªÙ† Ø§Ù„Ø«Ø§Ù†ÙŠ ÙÙŠ Ø§Ù„ÙÙŠØ²ÙŠØ§Ø¡ØŸ"`;
    }
    
    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø© Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
    getSubjectName(subject) {
        const names = {
            physics: 'Ø§Ù„ÙÙŠØ²ÙŠØ§Ø¡',
            math: 'Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª',
            chemistry: 'Ø§Ù„ÙƒÙŠÙ…ÙŠØ§Ø¡',
            arabic: 'Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©',
            biology: 'Ø§Ù„Ø£Ø­ÙŠØ§Ø¡',
            engineering: 'Ø§Ù„Ù‡Ù†Ø¯Ø³Ø©',
            islamic: 'Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©',
            geography: 'Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠØ§',
            history: 'Ø§Ù„ØªØ§Ø±ÙŠØ®'
        };
        return names[subject] || subject;
    }
}

// ØªØµØ¯ÙŠØ± Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…
if (typeof module !== 'undefined' && module.exports) {
    module.exports = { knowledgeBase, SmartSearchEngine };
}
